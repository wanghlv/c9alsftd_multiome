# Single nucleus multiome analysis of the prefrontal cortex from C9orf72 ALS/FTD patients illuminates pathways affected during disease progression
Hsiao-Lin Wang Dec 2022

Victor Corces Lab | Department of Human Genetics | Emory University School of Medicine

All analysis was performed in the R programming language (v4.1.1). Analysis code/scripts are available as
[RMarkdown files](https://github.com/wanghlv/c9alsftd_multiome/tree/main/RMarkdown) and they can be browsed with the links below.

The cell barcode and major cell type metadata for the Emory samples can be found in the meta/ folder. (updated March 2025)

## Processing and analyses of single nucleus multiome data
Including processing with ArchR pipeline, identification of cluster and cell type assignments, and snATAC-seq peak calling, etc.
[Scripts](https://github.com/wanghlv/c9alsftd_multiome/blob/main/RMarkdown/c9alsftd_multiome_ArchR.Rmd)

## Comparison of snRNA-seq differential gene expression and snATAC-seq differential chromatin accessibility analysis
ArchR getMarkerFeatures() with default parameters (the Wilcoxon rank sum test) GeneExpressionMatrix and PeakMatrix generated by ArchR were used for differential genes and differential accessibility analysis, respectively. [Scripts](https://github.com/wanghlv/c9alsftd_multiome/blob/main/RMarkdown/c9alsftd_multiome_differential.Rmd)

## Ambient RNA analysis
SoupX was used to estimate the levels of ambient RNA in each snRNA-seq dataset. The automated method was used for estimating the ambient RNA contaminated fraction and adjustCounts() was used to compute the final adjustment of RNA expression count matrix based on the estimated RNA contamination profile. [Scripts](https://github.com/wanghlv/c9alsftd_multiome/blob/main/RMarkdown/c9alsftd_multiome_SoupX.Rmd)

## Analysis of oligodendrocyte lineage
Differential gene analysis of oligodendrocyte and analysis of developmental stages of the oligodendrocyte lineage cells in control and C9orf72 donors. [Scripts](https://github.com/wanghlv/c9alsftd_multiome/blob/main/RMarkdown/c9alsftd_multiome_Oligodendrocyte.Rmd)

## Analysis of microglia
Analysis of dysregulation of microglia function in C9orf72 ALS/FTD donors. [Scripts](https://github.com/wanghlv/c9alsftd_multiome/blob/main/RMarkdown/c9alsftd_multiome_microglia.Rmd)

## Pseudotime analysis of astrocyte cell clusters
Trajectory analysis of astrocytes using snRNA-seq gene expression (left) and snATAC-seq gene score matrices. [Scripts](https://github.com/wanghlv/c9alsftd_multiome/blob/main/RMarkdown/c9alsftd_multiome_ASC_pseudotime.Rmd)

## Analysis of neuronal clusters
Weighted correlation network analysis on neuronal cell clusters, drifferential cell abundance analysis, and reverse deconvolution with pTDP-43 sorted bulk RNA-seq datasets. [Scripts](https://github.com/wanghlv/c9alsftd_multiome/blob/main/RMarkdown/c9alsftd_multiome_Neuronalclusters.Rmd)
